<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.51799c192fa25789803b.css" id="gatsby-global-css">@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-8d7d79679b70dbe27172b6460e7a7910.woff2) format("woff2"),url(/static/montserrat-latin-100-ec38980a9e0119a379e2a9b3dbb1901a.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-e279051046ba1286706adc886cf1c96b.woff2) format("woff2"),url(/static/montserrat-latin-100italic-3b325a3173c8207435cd1b76e19bf501.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-9d266fbbfa6cab7009bd56003b1eeb67.woff2) format("woff2"),url(/static/montserrat-latin-200-2d8ba08717110d27122e54c34b8a5798.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-6e5b3756583bb2263eb062eae992735e.woff2) format("woff2"),url(/static/montserrat-latin-200italic-a0d6f343e4b536c582926255367a57da.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-00b3e893aab5a8fd632d6342eb72551a.woff2) format("woff2"),url(/static/montserrat-latin-300-ea303695ceab35f17e7d062f30e0173b.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-56f34ea368f6aedf89583d444bbcb227.woff2) format("woff2"),url(/static/montserrat-latin-300italic-54b0bf2c8c4c12ffafd803be2466a790.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-b71748ae4f80ec8c014def4c5fa8688b.woff2) format("woff2"),url(/static/montserrat-latin-400-0659a9f4e90db5cf51b50d005bff1e41.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-6eed6b4cbb809c6efc7aa7ddad6dbe3e.woff2) format("woff2"),url(/static/montserrat-latin-400italic-7583622cfde30ae49086d18447ab28e7.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-091b209546e16313fd4f4fc36090c757.woff2) format("woff2"),url(/static/montserrat-latin-500-edd311588712a96bbf435fad264fff62.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-c90ced68b46050061d1a41842d6dfb43.woff2) format("woff2"),url(/static/montserrat-latin-500italic-5146cbfe02b1deea5dffea27a5f2f998.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-0480d2f8a71f38db8633b84d8722e0c2.woff2) format("woff2"),url(/static/montserrat-latin-600-b77863a375260a05dd13f86a1cee598f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-cf46ffb11f3a60d7df0567f8851a1d00.woff2) format("woff2"),url(/static/montserrat-latin-600italic-c4fcfeeb057724724097167e57bd7801.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-7dbcc8a5ea2289d83f657c25b4be6193.woff2) format("woff2"),url(/static/montserrat-latin-700-99271a835e1cae8c76ef8bba99a8cc4e.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-c41ad6bdb4bd504a843d546d0a47958d.woff2) format("woff2"),url(/static/montserrat-latin-700italic-6779372f04095051c62ed36bc1dcc142.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-db9a3e0ba7eaea32e5f55328ace6cf23.woff2) format("woff2"),url(/static/montserrat-latin-800-4e3c615967a2360f5db87d2f0fd2456f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-bf45bfa14805969eda318973947bc42b.woff2) format("woff2"),url(/static/montserrat-latin-800italic-fe82abb0bcede51bf724254878e0c374.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-e66c7edc609e24bacbb705175669d814.woff2) format("woff2"),url(/static/montserrat-latin-900-8211f418baeb8ec880b80ba3c682f957.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-4454c775e48152c1a72510ceed3603e2.woff2) format("woff2"),url(/static/montserrat-latin-900italic-efcaa0f6a82ee0640b83a0916e6e8d68.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300-fc117160c69a8ea0851b26dd14748ee4.woff2) format("woff2"),url(/static/merriweather-latin-300-58b18067ebbd21fda77b67e73c241d3b.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic-fe29961474f8dbf77c0aa7b9a629e4bc.woff2) format("woff2"),url(/static/merriweather-latin-300italic-23c3f1f88683618a4fb8d265d33d383a.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400-d9479e8023bef9cbd9bf8d6eabd6bf36.woff2) format("woff2"),url(/static/merriweather-latin-400-040426f99ff6e00b86506452e0d1f10b.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic-2de7bfeaf08fb03d4315d49947f062f7.woff2) format("woff2"),url(/static/merriweather-latin-400italic-79db67aca65f5285964ab332bd65f451.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700-4b08e01d805fa35d7bf777f1b24314ae.woff2) format("woff2"),url(/static/merriweather-latin-700-22fb8afba4ab1f093b6ef9e28a9b6e92.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic-cd92541b177652fffb6e3b952f1c33f1.woff2) format("woff2"),url(/static/merriweather-latin-700italic-f87f3d87cea0dd0979bfc8ac9ea90243.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900-f813fc6a4bee46eda5224ac7ebf1b7be.woff2) format("woff2"),url(/static/merriweather-latin-900-5d4e42cb44410674acd99153d57df032.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic-b7901d85486871c1779c0e93ddd85656.woff2) format("woff2"),url(/static/merriweather-latin-900italic-9647f9fdab98756989a8a5550eb205c3.woff) format("woff")}


/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{-webkit-text-size-adjust:100%;line-height:1.15}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden]{display:none}:root{--maxWidth-none:"none";--maxWidth-xs:20rem;--maxWidth-sm:24rem;--maxWidth-md:28rem;--maxWidth-lg:32rem;--maxWidth-xl:36rem;--maxWidth-2xl:42rem;--maxWidth-3xl:48rem;--maxWidth-4xl:56rem;--maxWidth-full:"100%";--maxWidth-wrapper:var(--maxWidth-2xl);--spacing-px:"1px";--spacing-0:0;--spacing-1:0.25rem;--spacing-2:0.5rem;--spacing-3:0.75rem;--spacing-4:1rem;--spacing-5:1.25rem;--spacing-6:1.5rem;--spacing-8:2rem;--spacing-10:2.5rem;--spacing-12:3rem;--spacing-16:4rem;--spacing-20:5rem;--spacing-24:6rem;--spacing-32:8rem;--fontFamily-sans:Montserrat,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--fontFamily-serif:"Merriweather","Georgia",Cambria,"Times New Roman",Times,serif;--font-body:var(--fontFamily-serif);--font-heading:var(--fontFamily-sans);--fontWeight-normal:400;--fontWeight-medium:500;--fontWeight-semibold:600;--fontWeight-bold:700;--fontWeight-extrabold:800;--fontWeight-black:900;--fontSize-root:16px;--lineHeight-none:1;--lineHeight-tight:1.1;--lineHeight-normal:1.5;--lineHeight-relaxed:1.625;--fontSize-0:0.833rem;--fontSize-1:1rem;--fontSize-2:1.2rem;--fontSize-3:1.44rem;--fontSize-4:1.728rem;--fontSize-5:2.074rem;--fontSize-6:2.488rem;--fontSize-7:2.986rem;--color-primary:#005b99;--color-text:#2e353f;--color-text-light:#4f5969;--color-heading:#1a202c;--color-heading-black:#000;--color-accent:#d1dce5}*,:after,:before{box-sizing:border-box}html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-size:var(--fontSize-root);line-height:var(--lineHeight-normal)}body{color:var(--color-text);font-family:var(--font-body);font-size:var(--fontSize-1)}footer{padding:var(--spacing-6) var(--spacing-0)}hr{background:var(--color-accent);border:0;height:1px}h1,h2,h3,h4,h5,h6{font-family:var(--font-heading);letter-spacing:-.025em;line-height:var(--lineHeight-tight);margin-bottom:var(--spacing-6);margin-top:var(--spacing-12)}h2,h3,h4,h5,h6{color:var(--color-heading);font-weight:var(--fontWeight-bold)}h1{color:var(--color-heading-black);font-size:var(--fontSize-6);font-weight:var(--fontWeight-black)}h2{font-size:var(--fontSize-5)}h3{font-size:var(--fontSize-4)}h4{font-size:var(--fontSize-3)}h5{font-size:var(--fontSize-2)}h6{font-size:var(--fontSize-1)}h1>a,h2>a,h3>a,h4>a,h5>a,h6>a{color:inherit;text-decoration:none}p{--baseline-multiplier:0.179;--x-height-multiplier:0.35;line-height:var(--lineHeight-relaxed);margin:var(--spacing-0) var(--spacing-0) var(--spacing-8) var(--spacing-0)}ol,p,ul{padding:var(--spacing-0)}ol,ul{list-style-image:none;list-style-position:outside;margin-bottom:var(--spacing-8);margin-left:var(--spacing-0);margin-right:var(--spacing-0)}ol li,ul li{padding-left:var(--spacing-0)}li>p,ol li,ul li{margin-bottom:calc(var(--spacing-8)/2)}li :last-child{margin-bottom:var(--spacing-0)}li>ul{margin-left:var(--spacing-8);margin-top:calc(var(--spacing-8)/2)}blockquote{border-left:var(--spacing-1) solid var(--color-primary);color:var(--color-text-light);font-size:var(--fontSize-2);font-style:italic;margin-bottom:var(--spacing-8);margin-left:calc(var(--spacing-6)*-1);margin-right:var(--spacing-8);padding:var(--spacing-0) var(--spacing-0) var(--spacing-0) var(--spacing-6)}blockquote>:last-child{margin-bottom:var(--spacing-0)}blockquote>ol,blockquote>ul{list-style-position:inside}table{border-collapse:collapse;border-spacing:.25rem;margin-bottom:var(--spacing-8);width:100%}table thead tr th{border-bottom:1px solid var(--color-accent)}a{color:var(--color-primary)}a:focus,a:hover{text-decoration:none}.global-wrapper{margin:var(--spacing-0) auto;max-width:var(--maxWidth-wrapper);padding:var(--spacing-10) var(--spacing-5)}.global-wrapper[data-is-root-path=true] .bio{margin-bottom:var(--spacing-20)}.global-header{margin-bottom:var(--spacing-12)}.main-heading{font-size:var(--fontSize-7);margin:0}.post-list-item{margin-bottom:var(--spacing-8);margin-top:var(--spacing-8)}.post-list-item p{margin-bottom:var(--spacing-0)}.post-list-item h2{color:var(--color-primary);font-size:var(--fontSize-4);margin-bottom:var(--spacing-2);margin-top:var(--spacing-0)}.post-list-item header{margin-bottom:var(--spacing-4)}.header-link-home{font-family:var(--font-heading);font-size:var(--fontSize-2);font-weight:var(--fontWeight-bold);text-decoration:none}.bio{display:flex;margin-bottom:var(--spacing-16)}.bio-avatar,.bio p{margin-bottom:var(--spacing-0)}.bio-avatar{border-radius:100%;margin-right:var(--spacing-4);min-width:50px}.blog-post header h1{margin:var(--spacing-0) var(--spacing-0) var(--spacing-4) var(--spacing-0)}.blog-post header p{font-family:var(--font-heading);font-size:var(--fontSize-2)}.blog-post-nav ul{margin:var(--spacing-0)}.gatsby-highlight{margin-bottom:var(--spacing-8)}@media (max-width:42rem){blockquote{margin-left:var(--spacing-0);padding:var(--spacing-0) var(--spacing-0) var(--spacing-0) var(--spacing-4)}ol,ul{list-style-position:inside}}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#000;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;text-align:left;text-shadow:0 1px #fff;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#b3d4fc;text-shadow:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{background:hsla(0,0%,100%,.5);color:#9a6e3a}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><meta name="generator" content="Gatsby 3.6.2"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=2c7a18d11ec6875aeabf478f416918a8" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=2c7a18d11ec6875aeabf478f416918a8"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=2c7a18d11ec6875aeabf478f416918a8"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=2c7a18d11ec6875aeabf478f416918a8"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=2c7a18d11ec6875aeabf478f416918a8"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=2c7a18d11ec6875aeabf478f416918a8"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=2c7a18d11ec6875aeabf478f416918a8"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=2c7a18d11ec6875aeabf478f416918a8"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=2c7a18d11ec6875aeabf478f416918a8"/><title data-react-helmet="true">Flush and Reload | Out of Order Core</title><meta data-react-helmet="true" name="description" content="Most cache side channel attacks requires a method to extract the secret from the cache. Flush and Reload is one such method to extract data from cache side channel that exploits cache invalidation instruction and accurate timers to achieve the goal"/><meta data-react-helmet="true" property="og:title" content="Flush and Reload"/><meta data-react-helmet="true" property="og:description" content="Most cache side channel attacks requires a method to extract the secret from the cache. Flush and Reload is one such method to extract data from cache side channel that exploits cache invalidation instruction and accurate timers to achieve the goal"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Kriyszig"/><meta data-react-helmet="true" name="twitter:title" content="Flush and Reload"/><meta data-react-helmet="true" name="twitter:description" content="Most cache side channel attacks requires a method to extract the secret from the cache. Flush and Reload is one such method to extract data from cache side channel that exploits cache invalidation instruction and accurate timers to achieve the goal"/><link as="script" rel="preload" href="/webpack-runtime-fd60f71f60829a3b87f3.js"/><link as="script" rel="preload" href="/framework-c4b9952841844d9091bc.js"/><link as="script" rel="preload" href="/app-3174bcc3c320f1993bcf.js"/><link as="script" rel="preload" href="/commons-ab2410dfbec4227df496.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-79300c07d367f2626517.js"/><link as="fetch" rel="preload" href="/page-data/flush-and-reload/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2841359383.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3257411868.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="global-wrapper" data-is-root-path="false"><header class="global-header"><a class="header-link-home" href="/">Out of Order Core</a></header><main><article class="blog-post" itemscope="" itemType="http://schema.org/Article"><header><h1 itemProp="headline">Flush and Reload</h1><p>June 23, 2021</p></header><section itemProp="articleBody"><p>This is the second post in series of timing analysis. If you haven’t read the first post - Timing Analysis (link opens a new tab), I highly recommend reading it to understand why these attacks are possible. If you have an idea of inclusive cache hierarchy and how OS loads shared library into virtual memory, you can continue with reading this article.</p>
<p>In this post, we will look at <strong>Flush and Reload</strong></p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 59.49367088607595%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACEElEQVQoz4WSz08TQRTH+8d58CL+CpoY4AAVicbEg4ly0Jh48eCBGI9G/xAjxqilrUUI1R6ICGKhu13sdmd2Z3dnt/sxM4WiFONLvtl5+16+877vO6WiKDCRJAlZlnFaFHkx/q8oTu0tHR2iKLKkJgaDAfv9Du1gny13h0+tVXYP2uz22jh9d0R2GmnJTKW1/oswTmMWKotc+HCdKx9vcrVyy37Pvy9zp/aIVKcjwpMoCSFwXZcwDNGZHsrPUuar9zm3MsellQUursxzubpg89v1h6SHff+VbMjzLEeEkvLyXc6+mWZieZaJt3MWZ15f48a7e8hQWlVxEltVBnEcWw9KR3swE0oh0EmCUopN9xsbnRYtb5O1dpO1vSYbbouWs2nraZpa6YbI5GYgc8mIMDV71JrBSQ0DcH526O67/FnM4wwl1b8lqyDgR72O12ySRRHmmiRNcLsuBQVO12Vr+zs6Hz6t+s5nVrfXx8wphUIQA7JeR87MEM3O0q9WbaMMAnzfHz2lXq9n92disfGEpS8vhtMW+TFh13FwhUBUKsSTk+ipKaJabdioNZ7n2d0YeAce+SC3tQfrT3n29eVwQopxybLRwJ+eJiyXCapVskNCs3THcSzM2RJm8LixxPP1V5BCFCuUGr7jY1OUwt/bI+h0kL5vXTcwDppG46ohNDC5jCS/+j5ShggZEgiJUjG/AVjredLmLK+BAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="An illustration depicting flush and reload attack using timing diagram"
        title="An illustration depicting flush and reload attack using timing diagram"
        src="/static/0de702cd1489b3fb2b53fb41d1c456a1/f058b/banner.png"
        srcset="/static/0de702cd1489b3fb2b53fb41d1c456a1/c26ae/banner.png 158w,
/static/0de702cd1489b3fb2b53fb41d1c456a1/6bdcf/banner.png 315w,
/static/0de702cd1489b3fb2b53fb41d1c456a1/f058b/banner.png 630w,
/static/0de702cd1489b3fb2b53fb41d1c456a1/f8067/banner.png 726w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<center>
Alt: An illustration depicting flush and reload attack using timing diagram<br/>
Made with <a href="https://excalidraw.com/" target="_blank">https://excalidraw.com/</a> (link opens a new tab)
</center>
<h3>Cache Placement</h3>
<p>Cache can be designed in few different ways. Cache has to store address and the data at that address. We have to map an address to a particular cache line and depending on design, there is a tradeoff between data retention in case of conflict and time to access. The following are the popular mapping (taught at an undergraduate level) for mapping addresses to cache line:</p>
<ul>
<li>Direct Mapping (1:1 associative) - Each address can be uniquely mapped to a particular cache line. For example, assume a system with 4 cache line that stores one byte each, (address % 4) gives the cache line to load data into.</li>
<li>Set Associative (1:m associative) - Each address can be mapped to m cache lines - This is known as a cache set. Modifying above example consider a cache set with 2 lines, the data at address will get loaded into (address % 2) cache set.</li>
<li>Fully associative - Here any address can be stored in any cache lines. The circuit used to resolved the correct cache line for a given address is more complicated than the other two.</li>
</ul>
<p>To read more about cache placement policies, you can read the Wikipedia article titled <a href="https://en.wikipedia.org/wiki/Cache_placement_policies" target="_blank">Cache Placement Policy</a> (link opens a new tab).</p>
<p>The main takeaway here is, with most popular design, the cache set for a data can be determined from the address. In case a new data is to be brought in to a set that is occupied, data needs to be evicted to make room for the new data. To know more about cache replacement, you can read the Wikipedia article titled <a href="https://en.wikipedia.org/wiki/Cache_replacement_policies" target="_blank">Cache Replacement Policy</a> (link opens a new tab).</p>
<p>The diagram below depicts cache eviction in case of conflict for direct associative cache.</p>
<center>
![Data at address 400 is resolved to cahce line 0](./1.png) 
Alt: Address 400 is resolved to cache line 0
![Data at address 400 is loaded in cache line 0](./2.png) 
Alt: Data at address 400 is loaded into cache line 0
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 438px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 87.34177215189874%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACIUlEQVQ4y42U34rTQBTG80Li9YLeipcu6Dv4CD6HsBfCSldYWl3R7uKFIv6rFKrQLjWx7XpnW5r+S9ts0naTyUw+OSedkK7b3Q4M57Q588v3zZmJEccxaNLQkXMk+XHzPR5/e4Lvf3/g3HFh923Yto3xeIzJZMJRT9d1YaSAFUxKiSiKEIoQUMDeaQ63P95HvlVE4F5ASMHA0WjE9cPhEP1+n9c5jgMjq3C5XHIhPSAlf8wzPK3s4+7XRzg6e4fIDxFGggFUQ4OUEZSAtDYFKqUwnU7XLUvguVXAzuddvGydIPIFK7wKSK4oX7OsiyiXseT8Res1dj49QKF5DOGF1wJZIdmkOZ/POZJSVhyrBNgk4C4KzSLC8wDiGsussN1uo1QqoVwuo1KpcPQ8L7V+0HjFlvPbAgeDAQM7nQ7LJpX0UCFRmPu9AjaKEASUNwDpYb1eTwv0kCvLOUsD3yLasIc00y5nIbrj2T3UwMPGm7TLpEgD9TFbOza6EVlo2pTGEe58ecjA0AsQyYgBdEu0Qsr/OzaXlWrLz34d4taHe9g381hM5ghEyAu1QuoBAfWx2whUK8U/2zXsnR7AGrQwc6Zr95gm2aQ4m804Xgm8fL+3GUEQ8D5uVJh+LFRyY7rdLmq1GkzTRLVa5d+WZfHZJdt6nXHTmzV4sVig1+txh8kmfaoo0n++76f1xjZ2stZFJCFVDCkVpFK810EosLxILP8DDPL935pz2WwAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Data at address 480 is resolved to cahce line 0"
        title="Data at address 480 is resolved to cahce line 0"
        src="/static/8074f99b8614bd40c935bb26bf6ae182/50e4b/3.png"
        srcset="/static/8074f99b8614bd40c935bb26bf6ae182/c26ae/3.png 158w,
/static/8074f99b8614bd40c935bb26bf6ae182/6bdcf/3.png 315w,
/static/8074f99b8614bd40c935bb26bf6ae182/50e4b/3.png 438w"
        sizes="(max-width: 438px) 100vw, 438px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span>
Alt: Address 480 is resolved to cache line 0</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 264px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 162.0253164556962%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAgCAYAAAASYli2AAAACXBIWXMAAAsTAAALEwEAmpwYAAADfElEQVRIx6WW227aShSG/ZC9aNyoaoryVt2X7U2bJ6CUkhalhSgKUrLVBEPMwdjG4COGxBj+rX9gLEOgyW5HGtmewzf/mrVmjRUAeHh4QBAE8H0faZqyCcvlEn9SlDAM8c+7d/j08SM+vH8Py7JEx2KxEND/W5V5mqLZakFrt/Hvr1+YTqf4m6LMkwTeYADfNBF7HtL5HEmSYDgcwnVdjMdj3N/fC8WTyUTUKIown8+FIn7HcSyEcLsUQ9Nwo6pwXr9GW1XRq9Xg+D60ZhOj0Qjtdht3d3digZubGziOI747nY5YjP3sM01TbJdiahpGR0dAoYCZqsKq1WD7PqIgECZQSa/XEyA6TbZ1u10MBgPhUBaqMwxjBbSPjrAoFBC+egXz5084QYDA88RAmsLJBFIxC01kGxfiO8tsNoOu61DMVgvDt2+xLBQQqSqMHz8wjiKEa4UcKIE0UQIJYzv7WbjPNF8Z6jqcHLB3dgYvjhGuzdsFpCP6/f5u4Jj7swaGqoputSqAwW+A9PJeoGcYm8Dv3wXQX+/hPiAdsBMYmOYGsPPt2wrounuBPF37gZaVOSU8OMiA3hNAhsxOIE8IwyYPdCcTeOvJnMAgfjaQx85aB7YAnp6ugH9qsmsYMN+8yYD66emTJv/WKfuAz/Eyg3s3MGeyXqk8GYcysAklaDOwt4Ffv65OSu7oyeSQB7KNjnkM7Pc3nKKXywIYhWE2kEqYGLbPMtPVToWWjMOXL6F/+SK8nAcy120DuQ22bT8Gcg/tHLBTKmEUhtkeciAnEiaBTGmMzW0gE68Ajo6PgeNjTA4O0P38GcMgyLINEyfV8Trw1p7nZCrcNpmLKE63i87hIaLDQ9gvXqBTLIqMba2zMVXRZALpBC7AzC1TP7O3zOICOKXHajUY9ToGjQbiIEA8naLVaonQ4EQC6O3b21uhSnqdJ4ZKuaB0kvI3VyZvQipjlT8ICq/CRZqKiuVSdMqLZ7vISfuKuOjzvx1csV6v4/r6Gufn52g0GiiXy7i4uICmaeISurq6QrVaFW2Xl5cZKPtzyAP5bDabYvDJyYmAsxaLRQHjAuwrlUqoVCriSRF5qJKXu+v9uSbLOY8UyndOTsWmp6JN/jzxmSTzbIsekmRD5SOF8hlNphiOXNjOGOEkhh9EcMYe4ukMI9eH54fwghC242Lsrb650H9xy0L1I0vsKQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Data at address 480 is loaded in cache line 0 overwriting data at address 400"
        title="Data at address 480 is loaded in cache line 0 overwriting data at address 400"
        src="/static/4170c618e912fcaa52a3ca4893238dcf/e61aa/4.png"
        srcset="/static/4170c618e912fcaa52a3ca4893238dcf/c26ae/4.png 158w,
/static/4170c618e912fcaa52a3ca4893238dcf/e61aa/4.png 264w"
        sizes="(max-width: 264px) 100vw, 264px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span>
Alt: Data at address 480 is loaded into cache line 0 overwriting previous data
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 438px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 87.34177215189874%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACA0lEQVQ4y42Uy27iQBBF/WlRtkjJ1+RjssgiUh5IkERZZI8EChvQSCBF2Y2QB2P8ZHi27bZvdCvTjiEzHlpqlaGrj+91VbdVFAU4OUz880OC8/IC9+IC4esr5osFXMeB4zjwfR9hGEo0c7FYwPra/wnQWiPLMmRJghSAe3WF5PQUUbsNf7dDnqYC9DxP8ufzOWazmewLggBWVeF2u5VELlDJj/d3/Ly8RHp+jvD5GXGaQqepAJjDQWWEEsi9JTDPc0RRtGc54YbbW6hGA8HTUy2Qrvi8Z9kkyUu0BnXHzSZ2jQb8x0dESVILFIW0ybleryVSqXyCPEcOIDLAhweEStVaFoWTyQSdTgfdbhf9fh+9Xg/L5VKSCQzu78Xy0UAuEmTbtsimSi4ahf7dXQmss7wHHI/HZUI5DoHtNuIkkbY5BHKWVa4yTMWr39AAvVZLqkwgFRmgabO9tikLUYEaYNBsQp2dwW+1ECmFPMsEwFNiFPL5W9scKjVA7/oa25MTeDc3mK/XyJSSjUah67oCNG33T6BRHAwGcvx+v73Bi2PMKueYkzYZ4ziW+FegQCsXxDFDsaW0rrFMlSw2WwjAL9vGcDjEaDTCYDCQNmN3sOVo2+yz/vdmY32z2WA6nUqFaZNXFSP/W61WZb51jJ3qPZlmGjovoHUOzcIVBVSSYrv7tPwBryEDxNM/NEUAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Data at address 400 is resolved to cahce line 0"
        title="Data at address 400 is resolved to cahce line 0"
        src="/static/29c5251517317cdfc30c65f448b48cf1/50e4b/5.png"
        srcset="/static/29c5251517317cdfc30c65f448b48cf1/c26ae/5.png 158w,
/static/29c5251517317cdfc30c65f448b48cf1/6bdcf/5.png 315w,
/static/29c5251517317cdfc30c65f448b48cf1/50e4b/5.png 438w"
        sizes="(max-width: 438px) 100vw, 438px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span>
Alt: Address 400 is resolved to cache line 0
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 264px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 158.22784810126583%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAgCAYAAAASYli2AAAACXBIWXMAAAsTAAALEwEAmpwYAAAD1ElEQVRIx6WWS28bVRiG568hAYsmgQUFBEhN3CKkFlViASvoihW/oewipWySLMiCJG7dRpR23CSOPXac+BKP7Tg3X+bq8YwT+0XvcWYy8SVAONbRjI/mPPN+l/N9IwGA53kwTROWZaHX63EJ/X7/VlM6PT3F01+fIvYyhme/PUOr1cK4wYeH/48FOm0Hya0d5HZzULZTcDsufNX+9GHn5+fif7fbxaQhZdQsHv/xI3549TOevPoFpRMVrUYTSlpBuVxGNptFtVqFpmnI5XI4OjrCwcGBuNq2jVKphOPjY5ycnKBer0N6sx/H+2tfYFp+gA+iXyKhptA4bcC0TPFGqqlUKjg7OwvcQaWqqgpQo9HAxcUFHMcRa5Kc28TMegSfyo/w8YsHSFUyaNVbMAxDbOaDBPLt3Mzhuq5QX6vVhErfpwIYz29hOjqHT+SHmHlxHzuqAr2pi4j7QG4OAzudjngJXeEDqTKfz0PaLCYwE41cAiNIHKRgagbMEHBYIdcIGwYWCgVICVW5Aj6PYLuYhKWbgQ/HAdvt9mRgqpoRJt+VH2L6eQRbhR0BNExjoskEHh4ejgema9kBME7gHDYLCQHUDX2iQkImAjNHe5hevwRG5/Auvw1TM6Hr+kSFhDDCfNEosLaHqbXZEaCma7cDpg+zAXDqGvCfFY41Wanu4s7qPdyNPxJA5uWwyf/Jh0olg6nV2WtAS7s5KH6UOUfTJgAOTOZRHE6bSUCazft/AbSCxOYxo2njTgorzg1AmjyLN7l3sHULlm0FQKohLAykalYb3l87ywK4NgDeic7ir31Z+NC69A2BVBIGco2RZ7UPAwOFg8Qm8B5e77+F2TIChSxVLJ7NZnOkfLFGhoHFYnEQ5Y/W7+Oz+LfCh69zb6E3tCAo3MyNw0DWvmGFrORSspzGh+tfYUb+Gu+tfY6Xe39CO2sFCtkFGRBWaz83udk3mT3GH1yTMuUsvvn9ezyO/oTvVp8gXdlFq95ESS2Jqs1o0vmE0UcsvFRMNVRMKNfYc4QPr/riVefyup7wGyc3sK9QFYNDtZxMF/YWQukOTvZ2SfTTy1+v38P/HVK4SXMw+8Nnlqb4gaACpgyV8Xn6d6TRh78KGDFZlhGPxzE/P49YLIbFxUUsLS1BURQkk0lsbGxgYWEBKysrWF5eFvAwQwp/VnDQZ36D99UyvxggBoJ+5TobPNfp2zBDuun75VY+HFYovr76fTidDuy2A8tuw/U8uK4n7j2vK64d1xXTtGzxXLd7LtRKk76yHKcDTTfR1IwArJuWgPBqmLaAaYYprrphCejfJpAuAZMY/d4AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Data at address 400 is loaded in cache line 0 overwriting data at address 480"
        title="Data at address 400 is loaded in cache line 0 overwriting data at address 480"
        src="/static/41d9971979ecc4fade1d1a46f8a5731f/e61aa/2.png"
        srcset="/static/41d9971979ecc4fade1d1a46f8a5731f/c26ae/2.png 158w,
/static/41d9971979ecc4fade1d1a46f8a5731f/e61aa/2.png 264w"
        sizes="(max-width: 264px) 100vw, 264px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span>
Alt: Data at address 400 is loaded into cache line 0 overwriting previous data</p>
<p>Cache thrashing in case of directly mapped cache here consecutive loads are resolved to same cache line thus over writing one another and degrading performance<br/>
Made with <a href="https://excalidraw.com/" target="_blank">https://excalidraw.com/</a> (link opens a new tab)</p>
</center>
<h2>CLFLUSH</h2>
<p>clflush is an x86 instruction that is used to flush a cache line corresponding to specific address through the entire cache hierarchy. If you are interested to learn more about clflush instruction, you can visit <a href="https://www.felixcloutier.com/x86/clflush" target="_blank">https://www.felixcloutier.com/x86/clflush</a> (link opens a new tab).</p>
<p>The important point with clflush is that it can be used at any privilege level and hence ever a program running in userspace with basic execution privilege can still run the clflush instruction. This allows for attacker to exploit clflush without escalating privilege level.</p>
<h2>Flush and Reload</h2>
<p>In flush and reload, the attacker thread flushes a particular cache line or a cache set where the shared library will be loaded. As we know the address beforehand, we only have to observe a small part of cache which makes this an efficient technique.</p>
<p>Once flushed, the attacker waits for a small amount of time before loading the shared library themself. If the call resolves quicker than expected, we realize the routine is cached in the last level cache shared between the hardware threads. As the attacker had flushed this cache line previously, they can now determine that the victim thread has called the shared library routine.</p>
<p>Based on this timing analysis, the attacker thread can track events on the victim thread.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 621px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 70.88607594936708%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAABiElEQVQoz5WT204bMRCG8/6Pg3pTqQiUDSC4oiQVtBG0LMlu3D15xl5v7PGh2vU2JFVSibmyx/70zz9jT8KJ0FrXdW2MCadjcjRLREII5xzn/MMwIhJRCAEAvPcx6f/G/2CttZQyrpVSXdf15N6FHT+JG2vtSBJVTWOdi9u2bZVSYzlSffvxk4v2QJmIACCEYLquvLuD21tVVfHYGCOECCE0KF/WJav491/Z7xoHyUN4KyVOp3Y2azebnUsEcM4/v7GhVl8UxTLNrXXvyog4wklibm4OYESybpmy3tQwuZd1obb6GDydmqsrOcCxMf2Rd1nBS+jN16hes/LA8zt8eamTROR5Dw9tk1J2Xee9X7Eq3dQrVu+6e0w5Sdp9WEglVTg1KmttbKluWzGb0fW1YmycnDUP6eLr60Js5TBt/+8L21eG8/PtxQWu1264m9X52fPnT+mXp2wZfDBkrLVEFMXHRwKcA2JZFPn9fTWfl1kGAqWQrGTz1eMie3xjK4GCcw4ATdPED/MH57socA7ZCWAAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="An image that illustrates how the timing changes with cached and un-cached data exaggerated for emphasis."
        title="An image that illustrates how the timing changes with cached and un-cached data exaggerated for emphasis."
        src="/static/e156606aabac6a89299bbf2a9fcae5c9/3075e/timing.png"
        srcset="/static/e156606aabac6a89299bbf2a9fcae5c9/c26ae/timing.png 158w,
/static/e156606aabac6a89299bbf2a9fcae5c9/6bdcf/timing.png 315w,
/static/e156606aabac6a89299bbf2a9fcae5c9/3075e/timing.png 621w"
        sizes="(max-width: 621px) 100vw, 621px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<center>
Alt: An image that illustrates how the timing changes with cached and un-cached data exaggerated for emphasis.<br/>
The picture is made using <a href="https://excalidraw.com/" target="_blank">https://excalidraw.com/</a> (link will open a new tab)
</center>
<h2>Leaking secrets</h2>
<p>To leak secrets, the victim thread must have a gadget that calls a shared library based on a secret. Consider the following code snippet:</p>
<div class="gatsby-highlight" data-language="cpp"><pre class="language-cpp"><code class="language-cpp"><span class="token keyword">unsigned</span> <span class="token keyword">int</span> secret<span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>secret<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>secret <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
                <span class="token function">shared_library_routine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        secret <span class="token operator">=</span> secret <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Based on timing analysis, the attacker thread can detect if <strong>shared_library_routine()</strong> is called by the victim and we know that this call happens only if the least significant bit of shifting secret is 1 and the attacker can decipher the entire secret just based on timing analysis.</p>
<h2>Complications</h2>
<p>Flush and reload have the following complications associated with it:</p>
<ul>
<li>The attacker and victim should run on the same physical core on separate threads at the same time.</li>
<li>The attacker and victim should share the last level cache. Without shared cache, this type of attack will not work.</li>
<li>The micro-architecture must implement a form of clflush instruction to facilitate flush and reload.</li>
<li>The timing between the flush and reload is important. If the timing is not right, the attacker might misinterpret the secret.</li>
</ul>
<h3>Scenarios with Flush and Reload</h3>
<p>The following images depicts the optimal flush and reload scenario:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 57.59493670886076%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACAElEQVQoz5WSy2tTQRTG85e5cFd3hSKo4KO0K6ULibgRLBKXFaQ7t90VXRTUlVYxramlmjTGEMFWLTFpbu7N4965j7mP+clMSGggKh74mMPMOd/MN9/JASRJQhAEOkUpZdae3aPTPmXQG9DtWKhUTZ3/KXJjQs/zJg1JllA/bvDxS5nDr5/5VK/guL3J+d9Ic7Zt4/s+QggUo8Ltn7tceneLxVKexfd5ruyscKdUwA+DKdJZyA2HQyNXk44Jnx+/4tzbi8ztXjc4v3OZG6U8QRTwr5hIdhyHMApRsaL4Y4+VD/fJHxS4vf+Am3v3KBw8xhMecRwTRZFBGIYG4zxN0xGhTpxuF+G6DIcDojCCDIgVSmYGWZwiI2kuDcLAEGhlZ2EIx9q/NZs0Tk4Y+L6Rb/4Kxf/G6IVS0tzaoru5iSiXZ358pjKzv98q86j8hJ7bp/WrRcfq0G63aTab5pW5U8vC63QQS0tk8/M4a2ukujPLpghTZXZ5evSCue2rWK5No96gWq1Sq9WoVCojwr7rImwbd3kZtbCAt74+U8pY/rPvL7nw5hr9YEAiE4QvJuaYsTEu+z6t1VX6+TzWxgZCSnwhzGzqW40BYWDMeX1U5G7xIVa/SxInEzJdpydgYkootYMRkZTIM9BFGnq09JrGqXFfj4rrCTwh8DzB0HWJIslvZvOA/Ik05XUAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="The attacker runs the flush, the victim runs the shared routine, the attacker then loads the same routine to find that it is cached based on timing and interprets a part of secret."
        title="The attacker runs the flush, the victim runs the shared routine, the attacker then loads the same routine to find that it is cached based on timing and interprets a part of secret."
        src="/static/da1d6a35e6d51ad43340a0d3faf3f68f/f058b/fr2.png"
        srcset="/static/da1d6a35e6d51ad43340a0d3faf3f68f/c26ae/fr2.png 158w,
/static/da1d6a35e6d51ad43340a0d3faf3f68f/6bdcf/fr2.png 315w,
/static/da1d6a35e6d51ad43340a0d3faf3f68f/f058b/fr2.png 630w,
/static/da1d6a35e6d51ad43340a0d3faf3f68f/f8067/fr2.png 726w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span> </p>
<center>
Alt: The attacker runs the flush, the victim runs the shared routine, the attacker then loads the same routine to find that it is cached based on timing and interprets a part of secret.
</center>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 59.49367088607595%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABvElEQVQoz6WRzWsTURTF509zpRu7sRCVJoKmfqEIbvxzXAiCC3HrqjYxtU2HgCjqiC3FSUkm03EyM+/NR2aSzE/eGyatqJv2wuG9d9/lcM49RlmWqJrNZsznc32ve+cpo74kSaJJL0yoVBVFoQnzPF8RnheGEALXdYnjeGX5IvWHZSmlVquUnoXq1agd1adak0KWZbpn1PtSCqMwpMhz/alQD9eknudhH9s4Ewf7eKjPJE1I01QLUjMrwrwosMdjfo5GuJ73T/siiPj68QvDQ5vvny0mQ+f/ltMwZGpZDE2T2Pf/CkfVwckRb60ttg932DrosX30gYHzibw4DdOIhSADpGkSNZuk7TaRaVYDi4UeWpRL/X5uveLSu+usde9wtXubK50Wjc5DPPFL/y/LJcbJZIIrBGJ3l6zRoNjYINnfr2QvK6IllcIXP15zeafFev8B1/bus7bX5lb/KX48rQSctSwHA4JWi3hzk6jfZwE6ILXLfF7o6Zff3rDeuUfz/RNudh9zo/eIu71njLwxxawK8zSUNCUYjYgcBxkEOnUFlZ5KUUHGkkCETKMAP5zi+h5+FCCkJBKSJM34DZiOhwu3tpD1AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="The attacker runs the flush, the victim doesn&#39;t the shared routine, the attacker then loads the same routine to find that it is not cached based on timing and interprets a part of secret."
        title="The attacker runs the flush, the victim doesn&#39;t the shared routine, the attacker then loads the same routine to find that it is not cached based on timing and interprets a part of secret."
        src="/static/a988ee8a803f7136dc2e36619c4b15be/f058b/fr1.png"
        srcset="/static/a988ee8a803f7136dc2e36619c4b15be/c26ae/fr1.png 158w,
/static/a988ee8a803f7136dc2e36619c4b15be/6bdcf/fr1.png 315w,
/static/a988ee8a803f7136dc2e36619c4b15be/f058b/fr1.png 630w,
/static/a988ee8a803f7136dc2e36619c4b15be/f8067/fr1.png 726w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span> </p>
<center>
Alt: The attacker runs the flush, the victim doesn't the shared routine, the attacker then loads the same routine to find that it is not cached based on timing and interprets a part of secret.
</center>
<br />
<br />
<p>The following are scenarios where attacker didn’t time the flush and reload correctly:<br>
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 59.49367088607595%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACSUlEQVQoz22Tz08TQRzF+495Ml4knECiAv6CRNDEmHgzxph4MjHRGC8mBA8eNPGmxgMhaCBgKQVLoUUKgqVd2gVpd3d2Z3+0ux+zU1po8CXfzGRnvi/vfd9sIooiYnieR6PRoA1HOFT3qxweHFLRKnjS7ZwRQdx3utTnKCLRIXAcRRpDBi6bxS2WsmlWchm1Vms6buChmweExwSn0SZNxKqCIFCE0mupmMx/oOf7Da7O3+Py3F365m5zf/EJX7anGZgZV6S2ZWOYBrVaDSnliULLstB1Hdu28Ru+Opj49Z4L80NcSo7Tlxyj98cId5Ye8Wlniv7ZMbZK26xlsmwWNsnn8wghOkq7LBuWCU14s/qOc1P99H67ycWZ65yfvsKt2Qd8zH+m5+s1fms7lIslPN9TY/J9H9d1VQaJtvdYoWHUCYMG5ZrGciXLqp4jo6+Trq6ypm9QMXRWtCzCForIdmxlNxYTE8aj6xD6QUBxf59drUztqKaS/B+0P2UKhQLl3RKl3T21jysMw27L0jCobWywl0ohjv4qvmbYpBmFag2jUFkyLANXuiwVf5It55C2g2lZSp0itC2LOFuRSmEODSFHRjBTqVZqzeaZt9bGw+VnvFifOPN0EgfVKrplYS0s4A4MEAwO4iwutm4c2+hqOp7F48xzXuUmW9cIz6Ys0mnqw8PYo6OYyWQcNoHvK5td1WxAA56mX/I68xZ8cFyJlK0f4yQUKalrGmalgqjXVepxqQcvZafiNONG4QiOjDpC2FjCxrQEUrr8A5gjc8lCvt0iAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="The attacker runs the flush, the victim runs the shared routine twice by the time the attacker loads the same routine to find that it is cached based on timing. In doing so attacker misses a part of the leak."
        title="The attacker runs the flush, the victim runs the shared routine twice by the time the attacker loads the same routine to find that it is cached based on timing. In doing so attacker misses a part of the leak."
        src="/static/fdf70775a464ba97031174c7eb58fdb1/f058b/fr3.png"
        srcset="/static/fdf70775a464ba97031174c7eb58fdb1/c26ae/fr3.png 158w,
/static/fdf70775a464ba97031174c7eb58fdb1/6bdcf/fr3.png 315w,
/static/fdf70775a464ba97031174c7eb58fdb1/f058b/fr3.png 630w,
/static/fdf70775a464ba97031174c7eb58fdb1/f8067/fr3.png 726w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span> </p>
<center>
Alt: The attacker runs the flush, the victim runs the shared routine twice by the time the attacker loads the same routine to find that it is cached based on timing. In doing so attacker misses a part of the leak.
</center>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 560px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 77.21518987341771%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC3klEQVQ4y22TbW/bZBSG87v4xpeNbkXQ0cKGuqbrOlgihtgYSIwvW0Hr7xhMiKkICSGEkNalbhOnLevUQbu0WeolIc6cZH6PHce1cyE7TfqyHeno2Od5zq1z7uc+iV6vR+SR6bqO7/vx9yAX7Ae8qrdoqza2asWuKSpWy8BsGmgv1fjOoCbBETMM4zVAx3O4/3iBn57+yv0nv/DjxgL31n+Ocz/8/YB76w9oWeohYBiG7O/vxwnTNIeAYS+M4ytLZWzlE0ZySUbFGc7mLvVj7JcYzc5QaD4f1iQigGKxSL1efyOgaml8vHKND8SrTIhpJsTUgacZj+JKikKj2K8Jw+MjW5ZFEARHU2htnfczs5zOTnEmO33MR7JJzgjT7Bx02KNH4uSjRO44Dm2nTdfrohkat5bn+Wrte27mv+NG7g7Xc7e5Lt7mxuodvszPUVIk/I6P53n9DgeAUYcRWMRpNLrX9foU+D1kqUZN+g+l+hL5RY2m3KAqVVFkhdLzEqqqxnePAbZtm7IkUdjeplouU6vVhhSUqxW2trfYk/bYLe6ys7sTc/+s8IxKpRLzF1k88uDHdl3cqLjRQJJlgoP8kE9D45+tf9l4ssHm08041uryUCWv6VDb3ESdm8O5e5fW/DyuZQ3POr4X8zcrfk0qf4ur4jekV79lSviCxXK2vwRhQKLValGtVGjZNqYg0BkfJ7xwAePiRRxNOwLYYXL581iP7+YuM5qb4T1xlrcz5/lt769DQNu2aSoKuuuiZ7M4ySTBlStYqRSeYRwDvJy9yVj+Uz7Mp5nIpzm/9hlnhWn+kBb7gL3gxMhLS9jnzhEcdNjV9eGZ23X56GGKU5lJ3slMcTozychSkrf+HGOh8Ht8xw/8E4+iKMiPHtEQBOqCgNpsYphmvEGGabC695ictEbuxTor0irLJZHF4jJFuYSpG7F2hx0OpHPSjgr/MAm+G0C0pT503C6m3abjdfkf9qIhVZZEt34AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="The attacker runs the flush, the victim runs the shared routine but the attacker&#39;s load of the same routine is too quick and overlaps with the load of the victim. In doing so attacker misses interprets a part of the leak as the time taken is closer to that of a cache miss."
        title="The attacker runs the flush, the victim runs the shared routine but the attacker&#39;s load of the same routine is too quick and overlaps with the load of the victim. In doing so attacker misses interprets a part of the leak as the time taken is closer to that of a cache miss."
        src="/static/e8c3205f9925ff909165388c4b9d05f5/b06ae/fr4.png"
        srcset="/static/e8c3205f9925ff909165388c4b9d05f5/c26ae/fr4.png 158w,
/static/e8c3205f9925ff909165388c4b9d05f5/6bdcf/fr4.png 315w,
/static/e8c3205f9925ff909165388c4b9d05f5/b06ae/fr4.png 560w"
        sizes="(max-width: 560px) 100vw, 560px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<center>
Alt: The attacker runs the flush, the victim runs the shared routine but the attacker's load of the same routine is too quick and overlaps with the load of the victim. In doing so attacker misses interprets a part of the leak as the time taken is closer to that of a cache miss.
<br/>
All images are made using <a href="https://excalidraw.com/" target="_blank">https://excalidraw.com/</a> (link will open a new tab)
</center> 
<h2>Coming up next</h2>
<p>In the next post we’ll look at Prime and Probe - a an alternative to Flush are Reload technique that works on systems that don’t implement a variant of clflush instruction.</p>
<p>Thank you for reading till the end. I’m an undergraduate student keenly interested in Computer Architecture and I look at micro-architectural based attacks to understand more about the working of our hardware. If you find any inaccuracies in the above post, please reach out to me and I’ll address it in the next edit. Have a nice day!</p></section><hr/><footer><div class="bio"><div data-gatsby-image-wrapper="" style="width:50px;height:50px" class="gatsby-image-wrapper bio-avatar"><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;width:50px;height:50px;position:relative"></div><picture><source type="image/avif" data-srcset="/static/2c7a18d11ec6875aeabf478f416918a8/d4bf4/avatar.avif 50w,/static/2c7a18d11ec6875aeabf478f416918a8/ee81f/avatar.avif 100w" sizes="50px"/><source type="image/webp" data-srcset="/static/2c7a18d11ec6875aeabf478f416918a8/3faea/avatar.webp 50w,/static/2c7a18d11ec6875aeabf478f416918a8/6a679/avatar.webp 100w" sizes="50px"/><img data-gatsby-image-ssr="" layout="fixed" data-main-image="" style="opacity:0" sizes="50px" decoding="async" loading="lazy" data-src="/static/2c7a18d11ec6875aeabf478f416918a8/e5610/avatar.png" data-srcset="/static/2c7a18d11ec6875aeabf478f416918a8/e5610/avatar.png 50w,/static/2c7a18d11ec6875aeabf478f416918a8/e9b55/avatar.png 100w" alt="Profile picture"/></picture><noscript><picture><source type="image/avif" srcSet="/static/2c7a18d11ec6875aeabf478f416918a8/d4bf4/avatar.avif 50w,/static/2c7a18d11ec6875aeabf478f416918a8/ee81f/avatar.avif 100w" sizes="50px"/><source type="image/webp" srcSet="/static/2c7a18d11ec6875aeabf478f416918a8/3faea/avatar.webp 50w,/static/2c7a18d11ec6875aeabf478f416918a8/6a679/avatar.webp 100w" sizes="50px"/><img data-gatsby-image-ssr="" layout="fixed" data-main-image="" style="opacity:0" sizes="50px" decoding="async" loading="lazy" src="/static/2c7a18d11ec6875aeabf478f416918a8/e5610/avatar.png" srcSet="/static/2c7a18d11ec6875aeabf478f416918a8/e5610/avatar.png 50w,/static/2c7a18d11ec6875aeabf478f416918a8/e9b55/avatar.png 100w" alt="Profile picture"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1)}}</script></div><p><strong>Hello </strong> <!-- -->I&#x27;m Prateek Nayak, an undergraduate student studying Computer Science. This blog hosts my explanations about various interesting stuff I&#x27;ve understood (or thought I&#x27;ve understood) while exploring the microarchiteture that powers our modern computers. People say I&#x27;m a pleasant person so don&#x27;t hesitate if you ever want to reach out to me regarding errors in this blog or just to discuss computer architecture in general<br/><strong>Note</strong>: Hyperlinks below open a new tab.<br/>You can reach out to me via <strong><a href="mailto:kprateeknayak@gmail.com" rel="noreferrer" target="_blank">Email</a></strong>, <strong><a href="https://twitter.com/Kriyszig" rel="noreferrer" target="_blank">Twitter</a></strong>, or <strong><a href="https://github.com/outofordercore/outofordercore.github.io/issues" rel="noreferrer" target="_blank">Github</a></strong><br/>Avatar stolen from <strong><a href="https://knowyourmeme.com/photos/1896667-soy-boy-face-soyjak" rel="noreferrer" target="_blank">KnowYourMeme</a></strong></p></div></footer></article><nav class="blog-post-nav"><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/timing-analysis/">← <!-- -->Timing Analysis</a></li><li><a rel="next" href="/prime-and-probe/">Prime and Probe<!-- --> →</a></li></ul></nav></main><footer>© <!-- -->2021<!-- -->, Built with<!-- --> <a href="https://www.gatsbyjs.com">Gatsby</a></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/flush-and-reload/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-d2a314c619ae9d8e67ff.js"],"app":["/app-3174bcc3c320f1993bcf.js"],"component---src-pages-404-js":["/component---src-pages-404-js-97593667e44e4660bc60.js"],"component---src-pages-index-js":["/component---src-pages-index-js-ab7584f4339b0441676f.js"],"component---src-pages-using-typescript-tsx":["/component---src-pages-using-typescript-tsx-ec89e82605e2a0c5e9c7.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-79300c07d367f2626517.js"]};/*]]>*/</script><script src="/polyfill-d2a314c619ae9d8e67ff.js" nomodule=""></script><script src="/component---src-templates-blog-post-js-79300c07d367f2626517.js" async=""></script><script src="/commons-ab2410dfbec4227df496.js" async=""></script><script src="/app-3174bcc3c320f1993bcf.js" async=""></script><script src="/framework-c4b9952841844d9091bc.js" async=""></script><script src="/webpack-runtime-fd60f71f60829a3b87f3.js" async=""></script></body></html>